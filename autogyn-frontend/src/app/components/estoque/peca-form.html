<!-- src/app/components/estoque/peca-form.component.html -->
<div class="form-container">
  <h2>{{ editMode ? 'Editar Peça' : 'Nova Peça' }}</h2>

  <form [formGroup]="pecaForm" (ngSubmit)="onSubmit()" class="p-fluid">

    <!-- Campo Nome -->
    <div class="p-field" [ngClass]="{ 'invalid-field': pecaForm.get('nome')?.invalid && pecaForm.get('nome')?.touched }">
      <label for="nome">Nome *</label>
      <input id="nome" type="text" pInputText formControlName="nome" placeholder="Nome da peça" />
      <div class="campo-erro" *ngIf="pecaForm.get('nome')?.invalid && pecaForm.get('nome')?.touched">
        Nome é obrigatório.
      </div>
    </div>

    <!-- Campo Código -->
    <div class="p-field" [ngClass]="{ 'invalid-field': pecaForm.get('codigo')?.invalid && pecaForm.get('codigo')?.touched }">
      <label for="codigo">Código *</label>
      <input id="codigo" type="text" pInputText formControlName="codigo" placeholder="Ex: P-1234" />
      <div class="campo-erro" *ngIf="pecaForm.get('codigo')?.errors?.['required'] && pecaForm.get('codigo')?.touched">
        Código é obrigatório.
      </div>
      <small class="invalid-feedback" *ngIf="pecaForm.get('codigo')?.hasError('pattern') && pecaForm.get('codigo')?.touched">
        Código inválido. Use o formato <strong>P-0000</strong>
      </small>
    </div>

    <!-- Campo Descrição -->
    <div class="p-field">
      <label for="descricao">Descrição</label>
      <textarea id="descricao" rows="2" pInputTextarea formControlName="descricao" placeholder="Descrição da peça"></textarea>
    </div>

    <!-- Quantidade -->
    <div class="p-field" [ngClass]="{ 'invalid-field': pecaForm.get('quantidade')?.invalid && pecaForm.get('quantidade')?.touched }">
      <label for="quantidade">Quantidade *</label>
      <p-inputNumber id="quantidade" formControlName="quantidade" inputId="quantidade" [min]="0"></p-inputNumber>
      <div class="campo-erro" *ngIf="pecaForm.get('quantidade')?.invalid && pecaForm.get('quantidade')?.touched">
        Quantidade inválida.
      </div>
    </div>

    <!-- Valor Unitário -->
    <div class="p-field" [ngClass]="{ 'invalid-field': pecaForm.get('valorUnitario')?.invalid && pecaForm.get('valorUnitario')?.touched }">
      <label for="valorUnitario">Valor Unitário (R$) *</label>
      <p-inputNumber id="valorUnitario" formControlName="valorUnitario" mode="currency" currency="BRL" locale="pt-BR" [min]="0"></p-inputNumber>
      <div class="campo-erro" *ngIf="pecaForm.get('valorUnitario')?.invalid && pecaForm.get('valorUnitario')?.touched">
        Valor inválido.
      </div>
    </div>

    <!-- Estoque Mínimo -->
    <div class="p-field" [ngClass]="{ 'invalid-field': pecaForm.get('estoqueMinimo')?.invalid && pecaForm.get('estoqueMinimo')?.touched }">
      <label for="estoqueMinimo">Estoque Mínimo</label>
      <p-inputNumber id="estoqueMinimo" formControlName="estoqueMinimo" [min]="0"></p-inputNumber>
      <div class="campo-erro" *ngIf="pecaForm.get('estoqueMinimo')?.invalid && pecaForm.get('estoqueMinimo')?.touched">
        Estoque mínimo inválido.
      </div>
    </div>

    <!-- Botões -->
    <div class="button-group">
      <button
        pButton
        type="submit"
        icon="pi pi-check"
        label="Salvar Peça"
        class="submit-button"
        [disabled]="pecaForm.invalid"
      ></button>

      <button
        pButton
        type="button"
        icon="pi pi-arrow-left"
        label="Voltar para Lista"
        class="submit-button"
        (click)="voltar()"
      ></button>
    </div>
  </form>
</div>
