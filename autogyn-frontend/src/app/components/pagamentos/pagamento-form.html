<div class="form-container">
  <h2>Registrar Pagamento</h2>

  <form [formGroup]="pagamentoForm" (ngSubmit)="onSubmit()" class="formulario">
    <!-- Ordem de Serviço -->
    <div class="form-group" [ngClass]="{ 'invalid': isInvalid('ordemDeServicoId') }">
      <label for="ordemDeServicoId">Ordem de Serviço</label>
      <input
        type="number"
        id="ordemDeServicoId"
        formControlName="ordemDeServicoId"
        pInputText
        placeholder="Informe o ID da OS"
      />
      <div class="erro-campo" *ngIf="isInvalid('ordemDeServicoId')">
        Campo obrigatório.
      </div>
    </div>

    <!-- Valor Pago -->
    <div class="form-group" [ngClass]="{ 'invalid': isInvalid('valorPago') }">
      <label for="valorPago">Valor Pago</label>
      <p-inputNumber
        inputId="valorPago"
        formControlName="valorPago"
        mode="currency"
        currency="BRL"
        locale="pt-BR"
        [inputStyle]="{ width: '100%' }"
      ></p-inputNumber>
      <div class="erro-campo" *ngIf="isInvalid('valorPago')">
        Informe um valor válido.
      </div>
    </div>

    <!-- Forma de Pagamento -->
    <div class="form-group" [ngClass]="{ 'invalid': isInvalid('formaPagamento') }">
      <label>Forma de Pagamento</label>
      <button type="button" pButton class="select-modal" (click)="abrirModal('formaPagamento')">
        {{ pagamentoForm.value.formaPagamento || 'Selecione' }}
      </button>
      <div class="erro-campo" *ngIf="isInvalid('formaPagamento')">
        Selecione uma opção.
      </div>
    </div>

    <!-- Status -->
    <div class="form-group" [ngClass]="{ 'invalid': isInvalid('status') }">
      <label>Status</label>
      <button type="button" pButton class="select-modal" (click)="abrirModal('status')">
        {{ pagamentoForm.value.status || 'Selecione' }}
      </button>
      <div class="erro-campo" *ngIf="isInvalid('status')">
        Campo obrigatório.
      </div>
    </div>

    <!-- Botão -->
    <button
      type="submit"
      pButton
      class="botao-submit"
      [disabled]="pagamentoForm.invalid || carregando"
    >
      <i *ngIf="carregando" class="pi pi-spin pi-spinner" style="margin-right: 0.5rem"></i>
      {{ carregando ? 'Registrando...' : 'Registrar Pagamento' }}
    </button>
  </form>

  <!-- MODAL DE SELEÇÃO -->
  <p-dialog
    [(visible)]="modalVisivel"
    [modal]="true"
    [closable]="true"
    [dismissableMask]="true"
    [style]="{ width: '300px' }"
    [baseZIndex]="1100"
  >
    <ng-template pTemplate="header">
      <h4>Selecionar {{ campoAtual === 'formaPagamento' ? 'Forma de Pagamento' : 'Status' }}</h4>
    </ng-template>

    <div *ngFor="let opcao of opcoesModal" class="modal-opcao" (click)="selecionarOpcao(opcao)">
      {{ opcao }}
    </div>
  </p-dialog>
</div>
